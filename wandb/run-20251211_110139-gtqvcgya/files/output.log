round 0 starts
==============  generator =============
WARNING:absl:`lr` is deprecated in Keras optimizer, please use `learning_rate` or use the legacy optimizer, e.g.,tf.keras.optimizers.legacy.Adam.
Model: "model"
__________________________________________________________________________________________________
 Layer (type)                   Output Shape         Param #     Connected to
==================================================================================================
 input_cur_phase (InputLayer)   [(None, 8)]          0           []

 input_feat2 (InputLayer)       [(None, 12)]         0           []

 embedding (Embedding)          (None, 8, 4)         8           ['input_cur_phase[0][0]']

 input_feat3 (InputLayer)       [(None, 12)]         0           []

 vec_1 (Lambda)                 (None, 1)            0           ['input_feat2[0][0]']

 activation (Activation)        (None, 8, 4)         0           ['embedding[0][0]']

 vec2_1 (Lambda)                (None, 1)            0           ['input_feat3[0][0]']

 vec_3 (Lambda)                 (None, 1)            0           ['input_feat2[0][0]']

 vec2_3 (Lambda)                (None, 1)            0           ['input_feat3[0][0]']

 vec_5 (Lambda)                 (None, 1)            0           ['input_feat2[0][0]']

 vec2_5 (Lambda)                (None, 1)            0           ['input_feat3[0][0]']

 vec_7 (Lambda)                 (None, 1)            0           ['input_feat2[0][0]']

 vec2_7 (Lambda)                (None, 1)            0           ['input_feat3[0][0]']

 vec_0 (Lambda)                 (None, 1)            0           ['input_feat2[0][0]']

 vec2_0 (Lambda)                (None, 1)            0           ['input_feat3[0][0]']

 vec_2 (Lambda)                 (None, 1)            0           ['input_feat2[0][0]']

 vec2_2 (Lambda)                (None, 1)            0           ['input_feat3[0][0]']

 vec_4 (Lambda)                 (None, 1)            0           ['input_feat2[0][0]']

 vec2_4 (Lambda)                (None, 1)            0           ['input_feat3[0][0]']

 vec_6 (Lambda)                 (None, 1)            0           ['input_feat2[0][0]']

 vec2_6 (Lambda)                (None, 1)            0           ['input_feat3[0][0]']

 num_vec_mapping (Dense)        (None, 4)            8           ['vec_0[0][0]',
                                                                  'vec_1[0][0]',
                                                                  'vec_2[0][0]',
                                                                  'vec_3[0][0]',
                                                                  'vec_4[0][0]',
                                                                  'vec_5[0][0]',
                                                                  'vec_6[0][0]',
                                                                  'vec_7[0][0]']

 phase_1 (Lambda)               (None, 4)            0           ['activation[0][0]']

 num_vec_mapping_part (Dense)   (None, 4)            8           ['vec2_0[0][0]',
                                                                  'vec2_1[0][0]',
                                                                  'vec2_2[0][0]',
                                                                  'vec2_3[0][0]',
                                                                  'vec2_4[0][0]',
                                                                  'vec2_5[0][0]',
                                                                  'vec2_6[0][0]',
                                                                  'vec2_7[0][0]']

 phase_3 (Lambda)               (None, 4)            0           ['activation[0][0]']

 phase_5 (Lambda)               (None, 4)            0           ['activation[0][0]']

 phase_7 (Lambda)               (None, 4)            0           ['activation[0][0]']

 phase_0 (Lambda)               (None, 4)            0           ['activation[0][0]']

 phase_2 (Lambda)               (None, 4)            0           ['activation[0][0]']

 phase_4 (Lambda)               (None, 4)            0           ['activation[0][0]']

 phase_6 (Lambda)               (None, 4)            0           ['activation[0][0]']

 lane_1 (Concatenate)           (None, 12)           0           ['num_vec_mapping[1][0]',
                                                                  'phase_1[0][0]',
                                                                  'num_vec_mapping_part[1][0]']

 lane_3 (Concatenate)           (None, 12)           0           ['num_vec_mapping[3][0]',
                                                                  'phase_3[0][0]',
                                                                  'num_vec_mapping_part[3][0]']

 lane_5 (Concatenate)           (None, 12)           0           ['num_vec_mapping[5][0]',
                                                                  'phase_5[0][0]',
                                                                  'num_vec_mapping_part[5][0]']

 lane_7 (Concatenate)           (None, 12)           0           ['num_vec_mapping[7][0]',
                                                                  'phase_7[0][0]',
                                                                  'num_vec_mapping_part[7][0]']

 lane_0 (Concatenate)           (None, 12)           0           ['num_vec_mapping[0][0]',
                                                                  'phase_0[0][0]',
                                                                  'num_vec_mapping_part[0][0]']

 lane_2 (Concatenate)           (None, 12)           0           ['num_vec_mapping[2][0]',
                                                                  'phase_2[0][0]',
                                                                  'num_vec_mapping_part[2][0]']

 lane_4 (Concatenate)           (None, 12)           0           ['num_vec_mapping[4][0]',
                                                                  'phase_4[0][0]',
                                                                  'num_vec_mapping_part[4][0]']

 lane_6 (Concatenate)           (None, 12)           0           ['num_vec_mapping[6][0]',
                                                                  'phase_6[0][0]',
                                                                  'num_vec_mapping_part[6][0]']

 lane_embedding (Dense)         (None, 24)           312         ['lane_1[0][0]',
                                                                  'lane_3[0][0]',
                                                                  'lane_5[0][0]',
                                                                  'lane_7[0][0]',
                                                                  'lane_0[0][0]',
                                                                  'lane_2[0][0]',
                                                                  'lane_4[0][0]',
                                                                  'lane_6[0][0]']

 WT_ET (Add)                    (None, 24)           0           ['lane_embedding[0][0]',
                                                                  'lane_embedding[1][0]']

 NT_ST (Add)                    (None, 24)           0           ['lane_embedding[2][0]',
                                                                  'lane_embedding[3][0]']

 WL_EL (Add)                    (None, 24)           0           ['lane_embedding[4][0]',
                                                                  'lane_embedding[5][0]']

 NL_SL (Add)                    (None, 24)           0           ['lane_embedding[6][0]',
                                                                  'lane_embedding[7][0]']

 concat_compete_phase_0_1 (Conc  (None, 48)          0           ['WT_ET[0][0]',
 atenate)                                                         'NT_ST[0][0]']

 concat_compete_phase_0_2 (Conc  (None, 48)          0           ['WT_ET[0][0]',
 atenate)                                                         'WL_EL[0][0]']

 concat_compete_phase_0_3 (Conc  (None, 48)          0           ['WT_ET[0][0]',
 atenate)                                                         'NL_SL[0][0]']

 concat_compete_phase_1_0 (Conc  (None, 48)          0           ['NT_ST[0][0]',
 atenate)                                                         'WT_ET[0][0]']

 concat_compete_phase_1_2 (Conc  (None, 48)          0           ['NT_ST[0][0]',
 atenate)                                                         'WL_EL[0][0]']

 concat_compete_phase_1_3 (Conc  (None, 48)          0           ['NT_ST[0][0]',
 atenate)                                                         'NL_SL[0][0]']

 concat_compete_phase_2_0 (Conc  (None, 48)          0           ['WL_EL[0][0]',
 atenate)                                                         'WT_ET[0][0]']

 concat_compete_phase_2_1 (Conc  (None, 48)          0           ['WL_EL[0][0]',
 atenate)                                                         'NT_ST[0][0]']

 concat_compete_phase_2_3 (Conc  (None, 48)          0           ['WL_EL[0][0]',
 atenate)                                                         'NL_SL[0][0]']

 concat_compete_phase_3_0 (Conc  (None, 48)          0           ['NL_SL[0][0]',
 atenate)                                                         'WT_ET[0][0]']

 concat_compete_phase_3_1 (Conc  (None, 48)          0           ['NL_SL[0][0]',
 atenate)                                                         'NT_ST[0][0]']

 concat_compete_phase_3_2 (Conc  (None, 48)          0           ['NL_SL[0][0]',
 atenate)                                                         'WL_EL[0][0]']

 concat_all (Concatenate)       (None, 576)          0           ['concat_compete_phase_0_1[0][0]'
                                                                 , 'concat_compete_phase_0_2[0][0]
                                                                 ',
                                                                  'concat_compete_phase_0_3[0][0]'
                                                                 , 'concat_compete_phase_1_0[0][0]
                                                                 ',
                                                                  'concat_compete_phase_1_2[0][0]'
                                                                 , 'concat_compete_phase_1_3[0][0]
                                                                 ',
                                                                  'concat_compete_phase_2_0[0][0]'
                                                                 , 'concat_compete_phase_2_1[0][0]
                                                                 ',
                                                                  'concat_compete_phase_2_3[0][0]'
                                                                 , 'concat_compete_phase_3_0[0][0]
                                                                 ',
                                                                  'concat_compete_phase_3_1[0][0]'
                                                                 , 'concat_compete_phase_3_2[0][0]
                                                                 ']

 constant_o (Lambda)            (None, 4, 3)         0           ['input_feat2[0][0]']

 reshape (Reshape)              (None, 4, 3, 48)     0           ['concat_all[0][0]']

 relation_embedding (Embedding)  (None, 4, 3, 4)     8           ['constant_o[0][0]']

 lane_conv (Conv2D)             (None, 4, 3, 20)     980         ['reshape[0][0]']

 relation_conv (Conv2D)         (None, 4, 3, 20)     100         ['relation_embedding[0][0]']

 combine_feature (Multiply)     (None, 4, 3, 20)     0           ['lane_conv[0][0]',
                                                                  'relation_conv[0][0]']

 combine_conv (Conv2D)          (None, 4, 3, 20)     420         ['combine_feature[0][0]']

 before_merge (Conv2D)          (None, 4, 3, 1)      21          ['combine_conv[0][0]']

 reshape_1 (Reshape)            (None, 4, 3)         0           ['before_merge[0][0]']

 q_values (Lambda)              (None, 4)            0           ['reshape_1[0][0]']

==================================================================================================
Total params: 1,865
Trainable params: 1,865
Non-trainable params: 0
__________________________________________________________________________________________________
Process Process-1:
